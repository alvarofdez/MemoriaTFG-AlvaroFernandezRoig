%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Plantilla de memoria en LaTeX para la ETSIT - Universidad Rey Juan Carlos
%%
%% Por Gregorio Robles <grex arroba gsyc.urjc.es>
%%     Grupo de Sistemas y Comunicaciones
%%     Escuela Técnica Superior de Ingenieros de Telecomunicación
%%     Universidad Rey Juan Carlos
%% (muchas ideas tomadas de Internet, colegas del GSyC, antiguos alumnos...
%%  etc. Muchas gracias a todos)
%%
%% La última versión de esta plantilla está siempre disponible en:
%%     https://github.com/gregoriorobles/plantilla-memoria
%%
%% Para obtener PDF, ejecuta en la shell:
%%   make
%% (las imágenes deben ir en PNG o JPG)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[a4paper, 12pt]{book}
%\usepackage[T1]{fontenc}

\usepackage[a4paper, left=2.5cm, right=2.5cm, top=3cm, bottom=3cm]{geometry}
\usepackage{times}
\usepackage[latin1]{inputenc}
\usepackage[spanish]{babel} % Comenta esta línea si tu memoria es en inglés
\usepackage[hyphens]{url}
%\usepackage[dvipdfm]{graphicx}
\usepackage{graphicx}
\usepackage{float}  %% H para posicionar figuras
\usepackage[nottoc, notlot, notlof, notindex]{tocbibind} %% Opciones de índice
\usepackage{latexsym}  %% Logo LaTeX
\usepackage{titlesec}
\setcounter{secnumdepth}{3}

\title{Memoria del Proyecto}
\author{Nombre del autor}

\renewcommand{\baselinestretch}{1.5}  %% Interlineado

\begin{document}

\renewcommand{\refname}{Bibliografía}  %% Renombrando
\renewcommand{\appendixname}{Apéndice}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% PORTADA

\begin{titlepage}
\begin{center}
\begin{tabular}[c]{c c}
%\includegraphics[bb=0 0 194 352, scale=0.25]{logo} &
\includegraphics[scale=0.25]{img/logo_vect.png} &
\begin{tabular}[b]{l}
\Huge
\textsf{UNIVERSIDAD} \\
\Huge
\textsf{REY JUAN CARLOS} \\
\end{tabular}
\\
\end{tabular}

\vspace{3cm}

\Large
GRADO EN INGENIERÍA EN TECNOLOGÍAS DE LA TELECOMUNICACIÓN

\vspace{0.4cm}

\large
Curso Académico 2018/2019

\vspace{0.8cm}

Trabajo Fin de Grado

\vspace{2.5cm}

\LARGE
TORNEOS CON DR. SCRATCH

\vspace{4cm}

\large
Autor : Álvaro Fernández Roig \\
Tutor : Dr. Gregorio Robles
\end{center}
\end{titlepage}

\newpage
\mbox{}
\thispagestyle{empty} % para que no se numere esta pagina


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Para firmar
\clearpage
\pagenumbering{gobble}
\chapter*{}

\vspace{-4cm}
\begin{center}
\LARGE
\textbf{Trabajo Fin de Grado}

\vspace{1cm}
\large
Torneos con Dr. Scratch

\vspace{1cm}
\large
\textbf{Autor :} Álvaro Fernández Roig \\
\textbf{Tutor :} Dr. Gregorio Robles Martínez

\end{center}

\vspace{1cm}
La defensa del presente Proyecto Fin de Carrera se realizó el día \qquad$\;\,$ de \qquad\qquad\qquad\qquad \newline de 2019, siendo calificada por el siguiente tribunal:


\vspace{0.5cm}
\textbf{Presidente:}

\vspace{1.2cm}
\textbf{Secretario:}

\vspace{1.2cm}
\textbf{Vocal:}


\vspace{1.2cm}
y habiendo obtenido la siguiente calificación:

\vspace{1cm}
\textbf{Calificación:}


\vspace{1cm}
\begin{flushright}
Fuenlabrada, a \qquad$\;\,$ de \qquad\qquad\qquad\qquad de 2019
\end{flushright}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Dedicatoria

\chapter*{}
\pagenumbering{Roman} % para comenzar la numeracion de paginas en numeros romanos
\begin{flushright}
\textit{
Dedicado a \\
mi familia, \\
por su permanente \\
e incondicional sostén
}
\end{flushright}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Agradecimientos

\chapter*{Agradecimientos}
%\addcontentsline{toc}{chapter}{Agradecimientos} % si queremos que aparezca en el índice
\markboth{AGRADECIMIENTOS}{AGRADECIMIENTOS} % encabezado 

En primer lugar, quiero dar las gracias a mis padres. Siempre he sentido por vuestra parte apoyo incondicional en cada una de mis decisiones. Obviamente, sin vuestro apoyo económico no hubiera podido finalizar la carrera, pero sin duda, tampoco sin vuestro apoyo emocional. 
Sé que estáis muy orgullosos de mi, siempre me lo habéis hecho ver. Habéis sabido respetarme siempre, estuvierais o no de acuerdo conmigo y eso tiene para mí un valor incalculable.

Por supuesto a mi hermano, gracias por tu paciencia en mis ratos de estudio, tus silencios y, por supuesto, todo tu apoyo y cariño.

A mis amigos, en los que siempre me he podido refugiar, gracias por los buenos momentos pero sobre todo gracias por estar ahí en los malos. A cada uno de vosotros os pertenece un cachito de esto.

A Alberto, Rebeca, Itziar y David, gracias por todo. Sin duda sois lo mejor que me ha pasado en mis años de universidad. Jamás lo hubiera conseguido sin vosotros.

Y a Sandra, por todo. Por tu amor todos estos años. Son tantas cosas que no podría enumerarlas, es una década de momentos. Gracias.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Resumen

\chapter*{Resumen}
%\addcontentsline{toc}{chapter}{Resumen} % si queremos que aparezca en el índice
\markboth{RESUMEN}{RESUMEN} % encabezado

Este proyecto consiste en la creación de un módulo de torneos para la aplicación Dr. Scratch. Dr. Scratch es una aplicación de análisis de proyectos Scratch que evalúa mediante parámetros algunos aspectos del pensamiento computacional.

El módulo se ha creado como una aplicación independiente, utilizando un modelo de datos aislado del resto de entidades de la aplicación original. Permite la creación y administración de torneos por parte de profesores y la participación en ellos de sus alumnos.

Con la creación de este módulo se ha tratado de fomentar una mayor utilización de la funcionalidad original, haciendo que su uso resulte atractivo para los estudiantes y práctico para los profesores.

El módulo de torneos con Dr. Scratch se ha desarrollado utilizando Django, un framework en lenguaje Python. Se ha utilizado una base de datos PostgreSQL, y para el diseño de las pantallas se ha utilizado el framework Bootstrap. 


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Resumen en inglés

\chapter*{Summary}
%\addcontentsline{toc}{chapter}{Summary} % si queremos que aparezca en el índice
\markboth{SUMMARY}{SUMMARY} % encabezado

This project consists in the creation of a new module for the Dr. Scratch application named tournaments of Dr. Scratch. Dr. Scratch is a Scratch project analysis application which evaluates some aspects of computational thinking through parameters.

The module has been created as an independent application, using a data model isolated from the other entities of the original application. It allows the creation and administration of tournaments by teachers and the participation of their students in them.

The creation of this module has tried to encourage greater use of the original functionality, making its use attractive for students and practical for teachers.

The tournament module of Dr. Scratch has been developed using Django, a Python framework. A PostgreSQL database has been used, and the Bootstrap framework has been used to create the templates.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% ÍNDICES %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Las buenas noticias es que los índices se generan automáticamente.
% Lo único que tienes que hacer es elegir cuáles quieren que se generen,
% y comentar/descomentar esa instrucción de LaTeX.

%%%% Índice de contenidos
\tableofcontents 
%%%% Índice de figuras
\cleardoublepage
%\addcontentsline{toc}{chapter}{Lista de figuras} % para que aparezca en el indice de contenidos
\listoffigures % indice de figuras
%%%% Índice de tablas
%\cleardoublepage
%\addcontentsline{toc}{chapter}{Lista de tablas} % para que aparezca en el indice de contenidos
%\listoftables % indice de tablas


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% INTRODUCCIÓN %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\cleardoublepage
\chapter{Introducción}
\label{sec:intro} % etiqueta para poder referenciar luego en el texto con ~\ref{sec:intro}
\pagenumbering{arabic} % para empezar la numeración de página con números

El siguiente trabajo consta de la realización de un módulo independiente para la aplicación Dr. Scratch. Se trata del módulo de torneos con Dr. Scratch, que permitirá a los docentes la creación de torneos y la participación en ellos de sus alumnos.

\section{Contexto}
\label{sec:contexto}

Dr. Scratch es una aplicación web que permite la evaluación de proyectos realizados a través de la herramienta Scratch. A través del análisis de los proyectos, Dr. Scratch puntúa en una escala de cero a tres una serie de parámetros relacionados con el pensamiento computacional, e identifica posibles errores en la realización de los proyectos, como duplicidades o código muerto. Los parámetros evaluados son paralelismo, pensamiento lógico, control de flujo, interactividad con el usuario, representación de la información, abstracción y sincronización.

La participación de los alumnos en los torneos con Dr. Scratch se realiza a través de la formación de equipos, fomentando de este modo el uso del aprendizaje cooperativo. Mediante el uso del aprendizaje cooperativo, los alumnos trabajan en grupos reducidos, de este modo intervienen no solo en su propio aprendizaje sino en el del resto de miembros del equipo, buscando un resultado beneficioso tanto para ellos mismos como para el resto de sus compañeros~\cite{johnson:_cooperative_learning}.

Así mismo, los torneos con Dr. Scratch permiten a los alumnos la autoevaluación en grupo de sus propios proyectos Scratch. A través de la autoevaluación, los alumnos participan activamente en el proceso de aprendizaje, aumentando su responsabilidad en el mismo y ligando el aprendizaje a sus intereses, capacidades y motivaciones~\cite{munoz:_autoevaluacion}.

\section{Estructura de la memoria}
\label{sec:estructura}

A continuación se detalla la estructura de la memoria.

\begin{itemize}
	\item \textbf{Capítulo 1: Introducción.} En este capítulo se desarrolla brevemente el contexto en el que se ha realizado el proyecto.
	\item \textbf{Capítulo 2: Objetivos.} En este capítulo se enumeran los objetivos que se pretenden alcanzar con la realización del proyecto.
	\item \textbf{Capítulo 3: Estado del arte.} En este capítulo se realiza una descripción de alto nivel de las diferentes tecnologías utilizadas en la realización del proyecto.
	\item \textbf{Capítulo 4: Diseño e implementación.} En este capítulo se describe el desarrollo del proyecto incluyendo su arquitectura y modelo de datos.
	\item \textbf{Capítulo 5: Resultados.} En este capítulo se describen y analizan los resultados obtenidos.
	\item \textbf{Capítulo 6: Conclusiones.} En este capítulo se indican las conclusiones a las que se ha llegado una vez finalizado el proyecto.
\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% OBJETIVOS %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\cleardoublepage % empezamos en página impar
\chapter{Objetivos} % título del capítulo (se muestra)
\label{chap:objetivos} % identificador del capítulo (no se muestra, es para poder referenciarlo)

\section{Objetivo general} % título de sección (se muestra)
\label{sec:objetivo-general} % identificador de sección (no se muestra, es para poder referenciarla)

La realización del módulo de torneos para Dr. Scratch surge bajo la premisa de realizar modificaciones en la aplicación de Dr. Scratch para tratar que ésta resulte más atractiva a los estudiantes que la utilicen y que esto ayude a su vez a fomentar un mayor uso de la aplicación original.


\section{Objetivos específicos}
\label{sec:objetivos-especificos}

\begin{itemize}
	\item Promover el análisis de proyectos Scratch a través de Dr. Scratch proporcionando un apartado de carácter lúdico que motive y atraiga a los estudiantes.
\end{itemize}
\begin{itemize}
	\item Proveer a los profesores de una aplicación administrable, que les permita tener el control de la creación, edición y borrado de las distintas entidades relacionadas con la creación de los torneos.
\end{itemize}
\begin{itemize}
	\item Mejorar el control y la evaluación por parte de los profesores de los proyectos realizados por sus alumnos, proporcionándoles información centralizada sobre el avance y resultados de los proyectos a través de la aplicación. 
\end{itemize}
\begin{itemize}
	\item Fomentar el trabajo cooperativo asociando las puntuaciones obtenidas a todos los participantes de un equipo de manera conjunta sin independizar entre sus miembros.
\end{itemize}
\begin{itemize}
	\item Permitir a los alumnos realizar una autoevaluación de sus proyectos Scratch mostrando información de ayuda para la mejora en los distintos parámetros evaluados.
\end{itemize}
\begin{itemize}
	\item Realizar una aplicación intuitiva, cuya información sea comprensible tanto por profesores como por alumnos y cuyos procesos sean sencillos y tengan un aspecto visual atractivo y en consonancia la aplicación de Dr. Scratch existente.
\end{itemize}

\section{Planificación temporal}
\label{sec:planificacion-temporal}

Sin duda la planificación del proyecto ha sido muy atípica. Gregorio, mi tutor, me presentó la idea del proyecto un lejano 18 de marzo del 2014. A lo largo de estos años he realizado, sin éxito, varios intentos de desarrollar el proyecto. El más fructífero en el año 2017, donde llegué a realizar parte de la funcionalidad y a reunirme nuevamente con Gregorio. Lamentablemente este intento también quedó en nada.

Finalmente en octubre de 2019 retomé, esta vez con plena dedicación, el desarrollo de la aplicación. De lo realizado en 2017 salvé parte del modelo pero comencé a realizar todo de nuevo, es por esto que el comienzo de la planificación es el 1 de octubre de 2019.

 \begin{figure}[H]
		\centering
	 \includegraphics[width=16cm, keepaspectratio]{img/planificacion}
	 \caption{Planificación temporal}
	 \label{fig:planificacion}
	\end{figure}
	
La duración de las jornadas ha cambiado a lo largo de la duración del proyecto.
\begin{itemize}
	\item Del 1 de octubre al 31 de enero: 4 horas al día en desarrollo.
  \item Del 1 de febrero al 13 de febrero: 4 horas al día en desarrollo y 4 horas al día en la memoria.
  \item Del 14 de febrero al 19 de febrero: 8 horas al día en el manual de usuario.
  \item Del 25 de febrero al 4 de marzo: 8 horas al día en el despliegue.
  \item Del 4 de marzo al 20 de marzo: 8 horas al día en la memoria.
	\item Del 5 de marzo al 13 de junio: pruebas de usuario, asistencia en remoto.
	\item Del 14 de junio al 16 de junio: 8 horas al día en la memoria. Inclusión de los resultados de las pruebas.
\end{itemize}	

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% ESTADO DEL ARTE %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\cleardoublepage
\chapter{Estado del arte}

A continuación se detallan las tecnologías utilizadas en el desarrollo del proyecto.

\section{Python} 
\label{sec:python}
Python\footnote{\url{https://www.python.org}} es un lenguaje de programación desarrollado a principios de los noventa por Guido van Rossum~\cite{donaldson:_python}.

Se trata de un lenguaje de programación de código abierto cuyas principales características son:
\begin{itemize}
	\item Es un lenguaje interpretado, por lo que a diferencia de otros lenguajes como Java o C no necesita compilación. Esto lo convierte en un lenguaje con un ciclo de desarrollo más rápido que el de los lenguajes compilados, dado que no requiere la compilación del código fuente cada vez que éste se cambia. Sin embargo, ser un lenguaje interpretado hace que su ejecución sea más lenta que la de los lenguajes compilados.
\end{itemize}
\begin{itemize}
	\item Es un lenguaje multiplataforma. Ser un lenguaje de programación interpretado hace que Python pueda ser ejecutado en cualquier sistema operativo que disponga de intérprete.
\end{itemize}
\begin{itemize}
	\item Es un lenguaje multiparadigma. Permite diferentes paradigmas de programación: programación orientada a objetos, programación imperativa y programación funcional.
\end{itemize}

\section{Django} 
\label{sec:django}

Django\footnote{\url{https://www.djangoproject.com}} es un framework de desarrollo web creado en el año 2003 por Adrian Holovaty y Simon Willison. En un principio, Django fue creado para administrar una serie de páginas web relacionadas con noticias, pero posteriormente fue lanzado en internet utilizando un modelo de código abierto.

Django presenta un mapeo objeto-relacional (ORM) que actúa entre el modelo de datos y el motor de base de datos y que permite que la modificación del motor de base de datos se realice simplemente modificando la configuración en su archivo de ajustes.

Así mismo, Django proporciona un servidor web ligero que puede usarse para desarrollo y pruebas, así como mensajes de error detallados en el modo de depuración, que hacen que el desarrollo y la corrección de errores sean sencillos.

Django también permite crear sitios web multilenguaje a través de su sistema de internacionalización, que simplifica la traducción de la interfaz~\cite{jaiswal:_django}.

\section{HTML} 
\label{sec:html}

HTML son las siglas de HyperText Markup Language, se trata del lenguaje estándar utilizado para la creación de páginas web. Fue creado por Tim Berners-Lee en los años ochenta. Es un lenguaje de marcas, esto quiere decir que para indicar la estructura del documento se utilizan etiquetas. Al ser un estándar, todos los navegadores leen e interpretan el lenguaje HTML y lo presentan de un modo similar.

\section{CSS} 
\label{sec:css}

CSS son las siglas de Cascading Style Sheets, es un lenguaje que permite establecer la apariencia de un documento escrito mediante un lenguaje de marcas. CSS permite asociar reglas a los elementos que aparecen en una página web, las reglas indican como debe representarse el contenido de esos elementos~\cite{larsen:_css}.

\section{JavaScript} 
\label{sec:javascript}

JavaScript es un lenguaje de programación creado por Brendan Eich, un trabajador de Netscape, en el año 1995. Se trata de un lenguaje que permite añadir interactividad en páginas web, pudiendo ejecutarse en el navegador del usuario.

Se trata de un lenguaje interpretado y orientado a objetos. Es también un lenguaje débilmente tipado, lo que significa que las variables no tienen que tener un tipo especificado \cite{flanagan:_javascript}.

\section{jQuery} 
\label{sec:jquery}

jQuery\footnote{\url{https://jquery.com}} es una librería de Javascript en código abierto creada en el año 2006 por John Resig, que simplifica la relación entre el documento HTML y Javascript.

jQuery simplifica la manipulación del documento HTML, el manejo de eventos, la realización de animaciones, las interacciones Ajax y el desarrollo de código Javascript aplicable a múltiples navegadores \cite{experts:_jquery}.

Así mismo, su amplia comunidad hace que jQuery esté siempre depurada y optimizada y que estén disponibles multitud de plugins, facilitando su uso.

\section{Bootstrap} 
\label{sec:bootstrap}

Bootstrap\footnote{\url{https://getbootstrap.com}} es un framework font-end que permite la construcción de páginas web adaptativas. Se trata de un software de código abierto creado en el año 2011 por Mark Otto y Jacob Thornton, empleados de Twitter.

Bootstrap ha evolucionado desde ser un proyecto enteramente basado en CSS hasta incluir múltiples plugins Javascript e iconos junto con formularios y botones. Presenta una cuadrícula de doce columnas y 940px de ancho \cite{spurlock:_bootstrap}.

La creación de páginas web mediante Bootstrap se simplifica al disponer de elementos predefinidos fácilmente incluibles en cualquier página web, tales como menús desplegables, botones, iconos, ventanas emergentes, etc.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% DISEÑO E IMPLEMENTACIÓN %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\cleardoublepage
\chapter{Diseño e implementación}
A continuación se detalla el módulo de torneos con Dr. Scratch, incuyendo su arquitectura y su modelo de datos.
\section{Arquitectura general}
El módulo de torneos está desarrollado usando el framework Django, cuya arquitectura está basada en el modelo vista controlador MVC. Sin embargo, la terminología utilizada por Django varía con respecto a otros frameworks. En este caso, el controlador se denomina vista y la vista plantilla o template, por lo que en lugar de utilizar el acrónimo MVC se utiliza el acrónimo MTV: model, template, view\footnote{\url{https://docs.djangoproject.com/es/2.1/faq/general/#django-appears-to-be-a-mvc-framework-but-you-call-the-controller-the-view-and-the-view-the-template-how-come-you-don-t-use-the-standard-names}}.

	\begin{figure}[H]
		\centering
	 \includegraphics[width=14cm, keepaspectratio]{img/arquitectura}
	 \caption{Arquitectura general}
	 \label{fig:arquitectura}
	\end{figure}
	
\subsection{Cliente}
\label{subsec:cliente}

En el lado del cliente se encuentra el navegador web del usuario. El usuario interactuará con la aplicación a través de peticiones HTTP que serán interpretadas en el lado del servidor. La creación de las plantillas con el framework Bootstrap permite que las pantallas sean responsive, es decir, que se ajusten automáticamente a la resolución de pantalla del dispositivo en el que se muestran. De este modo, las diferentes pantallas pueden visualizarse sin problemas tanto desde ordenadores como desde dispositivos móviles o tablets.

\subsection{Servidor}
\label{subsec:servidor}

En el lado del servidor se realiza el desarrollo back-end al completo, desde la recepción de peticiones HTTP hasta el acceso a datos.

En primer lugar, las peticiones HTTP son recibidas por un despachador de URLs denominado \texttt{urls.py}, en el que se define un mapeo de expresiones regulares donde cada expresión regular corresponde a un método de la vista \texttt{views.py}. De este modo, cuando se recibe una petición HTTP que cumple una expresión regular del despachador de URLs, éste invoca al método de la vista correspondiente.

En la vista \texttt{views.py} se encuentra la lógica de la aplicación, en cada método de la vista se recibe una serie de parámetros de entrada, se procesa la información recibida y finalmente, se retorna la información resultante al cliente a través de una plantilla. Estas plantillas son archivos en formato HTML en los que se muestra la información de la respuesta recibida desde la vista. En este caso, se ha utilizado el framework Bootstrap para el desarrollo del formato de las plantillas.

En la vista se realiza también el acceso a la base de datos, este acceso se realiza a través de las entidades existentes en el modelo \texttt{models.py}. Cada entidad del modelo corresponde a una tabla existente en la base de datos y para realizar las consultas se realizan llamadas a los diferentes métodos de la API Queryset de Django. A través de estos métodos pueden realizarse tanto consultas como inserciones, modificaciones o borrado de datos de la base de datos.

Cabe mencionar que en este caso se ha utilizado la librería Django Background Tasks\footnote{\url{https://django-background-tasks.readthedocs.io/en/latest}} para la creación de procesos asíncronos. La función a ejecutar se encuentra definida en el archivo \texttt{tasks.py} que actúa como una vista.

\section{Modelo de datos} 
\label{sec:modelodatos}

Para la creación del módulo de torneos con Dr. Scratch se ha utilizado un modelo de datos independiente del modelo existente en la aplicación original de Dr. Scratch. El diagrama de entidad-relación utilizado es el siguiente:

	\begin{figure}[H]
		\centering
	 \includegraphics[width=16cm, keepaspectratio]{img/model}
	 \caption{Diagrama de entidad-relación}
	 \label{fig:model}
	\end{figure}

A continuación se detallan las principales entidades del modelo. Estas definiciones ponen en contexto conceptos que deben ser previamente tenidos en cuenta a la hora de detallar el desarrollo de la aplicación.

\begin{itemize}
	\item \textbf{Creator:} La entidad \texttt{Creator} representa a los profesores, que serán los creadores de los torneos. Son los encargados de crear y administrar los torneos, de registrar a los participantes y de controlar y validar las partidas realizadas por los equipos. Para ello dispondrán de apartados solo para creadores que les permitan la realización de estas funciones.
	\item \textbf{CreatorHash:} Entidad creada para realizar el registro de creadores. El equipo de Dr. Scratch almacena un código hash en esta tabla y se lo proporciona a los profesores interesados en la utilización de torneos con Dr. Scratch para que puedan introducirlo en el formulario de registro.
	\item \textbf{Participant:} La entidad \texttt{Participant} representa a los estudiantes, que serán los participantes de los torneos creados. Su único cometido es jugar. Los participantes no disponen de acceso a las funcionalidades de administración y control destinadas a los creadores.
	\item \textbf{Tournament:} Los torneos son la entidad principal sobre la que se basa el juego y están compuestos por retos y equipos. Cada torneo lo juega uno o varios equipos, cada uno de esos equipos debe superar de uno en uno y en orden los retos que se hayan definido en el torneo. Cuando un equipo haya superado todos los retos superará el torneo, sin embargo, no se ha establecido un procedimiento de ganador.
	\item \textbf{Team:} Los equipos se componen de uno o varios participantes, permitiendo a los profesores establecer juegos individuales o por equipos. Pueden estar asociados a múltiples torneos.
\item \textbf{Challenge:} Los retos son los desafíos individuales que deberán superar los equipos y  pueden estar asociados a uno o más torneos. En ellos se determina un valor para cada uno de los parámetros de evaluación de Dr. Scratch. Para superar el reto, los equipos deberán realizar un análisis de un proyecto Scratch cuyo resultado en cada uno de los parámetros evaluados sea igual o superior a los valores establecidos en el reto.
\end{itemize}

	\begin{figure}[H]
		\centering
	 \includegraphics[width=10cm, keepaspectratio]{img/puntuacion_nosuperada}
	 \caption{Reto no superado}
	 \label{fig:puntuacion_nosuperada}
	\end{figure}
	
En la figura 4.3, los valores del reto se muestran en la columna \textit{Valor requerido}. El reto se superará cuando los valores obtenidos en los parámetros lógica, control de flujo, representación de los datos y sincronización sean iguales o mayores que los establecidos en el reto.
	
	\begin{figure}[H]
		\centering
	 \includegraphics[width=10cm, keepaspectratio]{img/puntuacion_superada}
	 \caption{Reto superado}
	 \label{fig:puntuacion_superada}
	\end{figure}
		
\begin{itemize}
	\item \textbf{ChallengesOfTournament:} Los retos definidos en un torneo deben tener un orden, para ello se ha definido la entidad \texttt{ChallengesOfTournament} cuyo atributo \texttt{position} ordena los retos de un torneo.
	\item \textbf{Game:} La entidad \texttt{Game} representa las partidas de los equipos. Cada partida está asociada a un equipo y a un reto concretos. En las figuras 4.3 y 4.4, los valores que representan la puntuación de la partida de un equipo se muestran en la columna \textit{Puntuación más alta}.
		
Las partidas son comunes para todos los participantes de un equipo, de este modo si un equipo tiene varios participantes y uno de ellos analiza un proyecto obteniendo una puntuación concreta, la partida se guarda y la puntuación será visualizada por el resto de participantes. 
		
Así mismo, los valores de la puntuación de la partida se sobrescriben solo si dicho valor en concreto es superior al de la partida existente, los valores que sean inferiores a su correspondiente valor en la partida existente no se actualizarán.
		
	\item \textbf{Background Task:} Los retos de un torneo pueden ser validados de manera automática, con el procedimiento descrito anteriormente, o de manera manual. Si se selecciona validación manual, cuando un reto haya sido superado por un equipo, se quedará en un estado intermedio denominado finalizado. En ese momento el creador deberá comprobar la puntuación y validar manualmente la partida que pasará al estado final completado. 
A continuación se muestra un diagrama de estados que describe el proceso que se realiza al jugar una partida.
	
\begin{figure}[H]
		\centering
	 \includegraphics[width=14cm, keepaspectratio]{img/estados_partida}
	 \caption{Diagrama de estados de una partida}
	 \label{fig:estados partida}
	\end{figure}
		
Se ha definido un mecanismo para notificar al creador a través del envío de correos electrónicos cuando un equipo finaliza una partida. Cuando el creador selecciona validación manual, puede también seleccionar la frecuencia en la que quiere recibir correos electrónicos de aviso. Las frecuencias son: nunca, inmediatamente, una vez al día y una vez a la semana.
		
Para el envío de correos con frecuencia una vez al día o una vez a la semana se ha creado un proceso asíncrono que revisa si existen partidas finalizadas y sin validar.
		
En la entidad \texttt{Background Task} se almacena un registro identificado con el email del creador y el identificador del torneo para cada ejecución asíncrona. Los registros se actualizan en cada una de las iteraciones del proceso.
\end{itemize}

\section{Diseño e implementación por funcionalidad} 
\label{sec:implementacion}

\subsection{Página principal, login y registro de creadores}

La aplicación se ha integrado como un módulo independiente dentro de Dr. Scratch. Para acceder se ha creado un enlace en la barra principal superior de Dr. Scratch que redirige a la página principal de torneos. 

\begin{figure}[H]
	\centering
 \includegraphics[width=16cm, keepaspectratio]{img/principal}
 \caption{Página principal de Dr. Scratch}
 \label{fig:principal}
\end{figure}

La página principal de torneos consta de un registro para creadores y de una sección en la barra superior con un menú de \textit{login}. La página principal se ha creado manteniendo el diseño existente en la sección de organizaciones de Dr. Scratch.

La aplicación torneos con Dr. Scratch presenta funcionalidades independientes que dependen de si el usuario es un profesor o un alumno. Para ello se ha definido un \textit{login} que identifica si el usuario es un creador o un participante y le redirige a una pantalla principal diferente en cada caso.

En el menú de \textit{login} también se encuentra la funcionalidad de recuperación de contraseña. En el proceso de recuperación de contraseña el usuario deberá introducir su email, que sirve para identificarle en la base de datos y enviarle un correo electrónico con un enlace único en el que se incluirá un token generado y que seguirá el siguiente formato: \texttt{\url{http://torneosdrscratch01.azurewebsites.net/reset_password_tournaments/MQ-54f-0bd3d0c01b4209132767/}}
\\Al pulsar en el enlace el usuario será dirigido a una página en la que podrá establecer una nueva contraseña.

Dado que los participantes pueden ser registrados con nombre de usuario y sin correo electrónico, si el participante no tiene asociada una cuenta de correo electrónico se envía el correo de recuperación de contraseña al creador que le haya registrado.

\begin{figure}[H]
	\centering
 \includegraphics[width=6cm, keepaspectratio]{img/principal_torneos_login}
 \caption{Página principal de torneos con Dr. Scratch: Menú de login}
 \label{fig:principal_torneos_login}
\end{figure}
\newpage
En cuanto al registro de creadores, se trata de un registro que sigue el mismo proceso que el utilizado para el registro de organizaciones de Dr. Scratch. El equipo de Dr. Scratch debe darle una clave al profesor para que la introduzca en el formulario de registro junto con su nombre de usuario, correo electrónico y contraseña. La clave proporcionada al profesor deberá encontrarse almacenada en el campo \texttt{hashkey} de la tabla \texttt{app\_creatorhash} y cuando el profesor se registre se eliminará de esta tabla y pasará a ser el campo \texttt{hashkey} de la tabla \texttt{app\_creator}.
\begin{figure}[H]
	\centering
 \includegraphics[width=16cm, keepaspectratio]{img/principal_torneos_registro}
 \caption{Página principal de torneos con Dr. Scratch: Registro de creadores}
 \label{fig:principal_torneos_registro}
\end{figure}

\subsection{Funcionalidades para creadores}

Los creadores dispondrán de un menú principal con cuatro funcionalidades independientes: administración de torneos, validación manual, progreso de los torneos y registrar nuevos participantes. La página principal de torneos se ha creado usando el componente \textit{carousel} de Bootstrap con el que se puede acceder a cada una de las funcionalidades existentes.

\begin{figure}[H]
	\centering
 \includegraphics[width=16cm, keepaspectratio]{img/main_creador}
 \caption{Página principal de creadores}
 \label{fig:main_creador}
\end{figure}

\subsubsection{Administración de torneos}

La administración de torneos consiste en un módulo de administración para poder consultar, crear, editar y borrar torneos, equipos y retos. En la pantalla principal se encuentra un enlace a la administración de cada una de las entidades que son administrables por separado.

\begin{figure}[H]
	\centering
 \includegraphics[width=16cm, keepaspectratio]{img/admin_creador}
 \caption{Página principal de la administración de torneos}
 \label{fig:admin_creador}
\end{figure}

\vspace{0.5cm}
\textbf{Retos}
\vspace{0.5cm}

Al acceder a la administración de retos se muestra un listado con los retos creados por el usuario. Por cada reto se muestra su nombre y descripción y tres botones que permiten ver el detalle del reto, editarlo o eliminarlo.
El listado se divide en páginas de tres elementos como máximo. La navegación entre páginas se realiza a través de un paginador.
Así mismo, en la parte inferior se encuentra un botón que permite crear un nuevo reto.
\begin{figure}[H]
	\centering
 \includegraphics[width=16cm, keepaspectratio]{img/lista_retos}
 \caption{Listado de retos}
 \label{fig:lista_retos}
\end{figure}

Para crear o editar un reto se ha definido un formulario de Django denominado \texttt{ChallengeForm} en el archivo \texttt{forms.py}. 

\begingroup
	\fontsize{7pt}{8pt}\selectfont
	\begin{verbatim}
		DIFFICULTY_CHOICES= [
    (0, _('None: 0')),
    (1, _('Easy: 1')),
    (2, _('Medium: 2')),
    (3, _('Hard: 3')),
    ]
    
class ChallengeForm (forms.Form):
    name = forms.CharField(max_length=50, widget=forms.TextInput(), required=True)
    description = forms.CharField(max_length=500, widget=forms.Textarea(), required=True)
    parallelism = forms.ChoiceField(widget=forms.RadioSelect, choices=DIFFICULTY_CHOICES, initial=0)
    logic = forms.ChoiceField(widget=forms.RadioSelect, choices=DIFFICULTY_CHOICES, initial=0)
    flowControl = forms.ChoiceField(widget=forms.RadioSelect, choices=DIFFICULTY_CHOICES, initial=0)
    userInteractivity = forms.ChoiceField(widget=forms.RadioSelect, choices=DIFFICULTY_CHOICES, initial=0)
    dataRepresentation = forms.ChoiceField(widget=forms.RadioSelect, choices=DIFFICULTY_CHOICES, initial=0)
    abstraction = forms.ChoiceField(widget=forms.RadioSelect, choices=DIFFICULTY_CHOICES, initial=0)
    synchronization = forms.ChoiceField(widget=forms.RadioSelect, choices=DIFFICULTY_CHOICES, initial=0)
	\end{verbatim}
\endgroup

Cuando se edita un reto, se recogen los valores del reto seleccionado de la base de datos y se precargan en el formulario \texttt{ChallengeForm} sobrescribiendo el parámetro \texttt{initial}.

Al pulsar en el botón \textit{Borrar} aparecerá una ventana modal en la que se solicita confirmación para borrar el reto. Al confirmar, el reto se borrará siempre y cuando no esté asociado a ningún torneo.

El detalle del reto despliega una ventana modal en la que, de manera visual a través de \textit{progress bars} de Bootstrap, se muestran los valores de cada uno de los parámetros del reto. Cada uno de los conceptos tendrá un enlace al tutorial de Dr. Scratch por si el profesor quiere revisar el significado de alguno de los conceptos de pensamiento computacional evaluables.

\begin{figure}[H]
	\centering
 \includegraphics[width=10cm, keepaspectratio]{img/detalle_reto}
 \caption{Detalle de un reto}
 \label{fig:detalle_reto}
\end{figure}

\vspace{0.5cm}
\textbf{Equipos}
\vspace{0.5cm}

Al acceder a la administración de equipos, se muestra una pantalla con un listado de equipos, esta pantalla tiene el mismo formato que el listado de retos de la figura 4.11, pudiendo crear, editar o borrar equipos y, además, consultar los participantes de los equipos creados.

El formulario de creación y edición de equipos se denomina \texttt{TeamForm} y sus campos son únicamente nombre y descripción.

\begingroup
	\fontsize{7pt}{8pt}
	\selectfont
	\begin{verbatim}    
		class TeamForm (forms.Form):
		    name = forms.CharField(max_length=50, widget=forms.TextInput(), required=True)
		    description = forms.CharField(max_length=500, widget=forms.Textarea(), required=True)
	\end{verbatim}
\endgroup
Para añadir participantes al equipo, se incluyen listas desplegables con los participantes que haya registrado el creador que está administrando el equipo. Podrán incluirse hasta un máximo de cinco participantes por equipo.
\begin{figure}[H]
	\centering
 \includegraphics[width=8cm, keepaspectratio]{img/nuevo_equipo}
 \caption{Creación de un equipo}
 \label{fig:nuevo_equipo}
\end{figure}
\newpage
El listado de los participantes de un equipo se muestra a través de una ventana modal.
\begin{figure}[H]
	\centering
 \includegraphics[width=7cm, keepaspectratio]{img/participantes_equipo}
 \caption{Ver participantes de un equipo}
 \label{fig:participantes_equipo}
\end{figure}

El borrado de un equipo se realiza del mismo modo que el borrado de retos. Se solicita confirmación a través de una ventana modal, no pudiendo borrarse equipos que se encuentren asociados a algún torneo.

\vspace{0.5cm}
\textbf{Torneos}
\vspace{0.5cm}

Al acceder a la administración de torneos, se muestra una pantalla con un listado de torneos, esta pantalla tiene el mismo formato que el listado de retos de la figura 4.11, pudiendo crear torneos o editar, borrar y ver el detalle de los torneos creados.

La creación de torneos consta de tres secciones. En primer lugar se define el nombre y la descripción del torneo. En segundo lugar, se establecen los equipos y retos del torneo. Podrán incluirse hasta un máximo de cuatro equipos y cuatro retos. Los retos incluidos se ordenarán de arriba a abajo con respecto al formulario. Para facilitar la creación de torneos, se han definido dos enlaces que abren sendas ventanas modales con los formularios de creación de retos y equipos respectivamente.
Y en tercer lugar debe seleccionarse la configuración de validación de los retos del torneo y la periodicidad de recepción de correos electrónicos de notificación. 

Para la creación y edición de torneos se ha creado el formulario denominado \texttt{TournamentForm}.

\begingroup
	\fontsize{7pt}{8pt}\selectfont
	\begin{verbatim}
		NOTIFICATION_CHOICES= [
		    (0, _('Never')),
		    (1, _('Immediately')),
		    (2, _('Once a day')),
		    (3, _('Once a week')),
		]
			
		class TournamentForm(forms.Form):
		    name = forms.CharField(max_length=50, widget=forms.TextInput(), required=True)
		    description = forms.CharField(max_length=500, widget=forms.Textarea(), required=True)
		    manualValidation = forms.BooleanField(widget=forms.CheckboxInput(), required=False)
		    notificationPeriod = forms.ChoiceField(widget=forms.Select(), choices=NOTIFICATION_CHOICES, initial=0)
	\end{verbatim}
\endgroup

\begin{figure}[H]
	\centering
 \includegraphics[width=8cm, keepaspectratio]{img/nuevo_torneo}
 \caption{Creación de un torneo}
 \label{fig:nuevo_torneo}
\end{figure}

El borrado de torneos se realizará del mismo modo que el borrado de equipos y retos. Al pulsar en el botón \textit{Borrar} se abre una ventana modal para pedir confirmación al creador.

Al pulsar el botón \textit{Detalle} se abre una ventana modal con la información de los retos y equipos establecidos, así como de la configuración de validación.

En la ventana modal aparece un listado con los nombres de los retos y los equipos, sin embargo, si se pasa el ratón por encima del nombre de un reto aparecerá el valor de sus parámetros y si se pasa por encima del nombre de un equipo aparecerán los nombres de usuario de sus participantes. De este modo el creador dispondrá de toda la información necesaria en el detalle de un torneo.

\begin{figure}[H]
	\centering
 \includegraphics[width=10cm, keepaspectratio]{img/detalle_torneo}
 \caption{Detalle de un torneo}
 \label{fig:detalle_torneo}
\end{figure}

\newpage
\subsubsection{Validación manual}
 
En la sección de validación manual se podrán comprobar y validar las partidas de los torneos seleccionados con la opción de validación manual.

Para discriminar entre las partidas en estado finalizado y las partidas en estado completado (figura 4.5), se han incluido dos campos en la entidad \texttt{Game} denominados \texttt{completed} y \texttt{done}.

\begingroup
	\fontsize{7pt}{8pt}\selectfont
	\begin{verbatim}
      completed = models.IntegerField(default=int(0))
      done = models.IntegerField(default=int(0))
	\end{verbatim}
\endgroup
		
Cuando una partida pasa al estado finalizado se marca el campo \texttt{done} con un 1. En el caso de que el torneo en cuestión sea de validación automática, el campo \texttt{completed} también se marca con un 1 y se pasa al siguiente reto, pero si el torneo es de validación manual, el campo \texttt{completed} será 0.

Por lo tanto, en la sección de validación manual aparecerán las partidas (\texttt{Game}) cuyo campo \texttt{done} sea 1 y su campo \texttt{completed} sea 0, y al validar una partida se marcará el campo \texttt{completed} a 1, pasando el equipo correspondiente al siguiente reto, si lo hubiera, o superando el torneo si fuera el último reto.

Para la sección de validación manual se han creado dos pantallas, la primera contiene un listado con todos los torneos que tienen alguna partida superada y sin validar. En este listado cada torneo tiene un botón denominado \textit{Validar Partidas} que lleva al creador a otro listado con los equipos de ese torneo que tienen partidas pendientes de validación.

\begin{figure}[H]
	\centering
 \includegraphics[width=12cm, keepaspectratio]{img/validar_torneos}
 \caption{Validación manual: listado de torneos}
 \label{fig:validacion_manual_torneos}
\end{figure}

En el segundo listado, cada equipo tiene a su vez un botón denominado \textit{Validar} que abre una ventana modal en la que el creador puede ver los miembros del equipo seleccionado, los valores de los parámetros del reto y la puntuación de la partida y en la que podrá finalmente validar la partida.

\begin{figure}[H]
  		\centering
		 \includegraphics[width=12cm, keepaspectratio]{img/validar_equipos}
 		 \caption{Validación manual: listado de equipos}
 		 \label{fig:validacion_manual_equipos}
	\end{figure}

\begin{figure}[H]
	\centering
 \includegraphics[width=8cm, keepaspectratio]{img/validar_partida}
 \caption{Validación manual: ventana modal}
 \label{fig:validacion_manual_listados_modal}
\end{figure}

\subsubsection{Progreso de los torneos}

En la sección de progreso de los torneos, los creadores podrán realizar un seguimiento de todas las partidas que se encuentren en curso para cada uno de los torneos que hayan creado.

Al acceder a la sección de progreso de los torneos se muestra un listado con los torneos creados por el usuario, que mantiene el formato usado en la figura 4.11. 

En este caso, cada torneo dispone de dos operaciones, la primera es poder ver el detalle de los torneos. El detalle tiene el mismo formato que el definido en la sección de administración (figura 4.16).

La segunda operación muestra la pantalla de progreso de los torneos. Esta pantalla tiene una finalidad meramente informativa y no presenta ninguna operación. En ella se muestra la información de las partidas del mismo modo que se muestra a los equipos a la hora de jugar. 

Con un título en rojo se muestra el nombre del equipo que ha realizado la partida y debajo, el nombre y descripción del torneo.

Bajo la descripción del torneo se muestra una barra de progreso con pasos, en la que cada paso corresponde a un reto del torneo. Con los botones \textit{Anterior} y \textit{Siguiente}, el creador podrá navegar por los distintos retos del torneo. A diferencia de los participantes, que no podrán avanzar al siguiente reto a no ser que completen el reto en el que se encuentran, el creador podrá navegar por todos los retos, estén superados o no por el equipo, para disponer de la información completa del torneo.

Los números de la barra de progreso siguen el siguiente código de colores: 
\begin{itemize}
	\item El reto marcado en \textbf{amarillo} será el reto seleccionado por el creador. Por lo tanto, la información que aparecerá en el panel será la correspondiente a ese reto. 
\item Los retos marcados en \textbf{verde} serán los retos superados por el equipo.
\item Los retos marcados en \textbf{gris} serán los retos que aún no se encuentran superados por el equipo.
\end{itemize}

Para crear la barra de progreso se ha utilizado el plugin jQuery Easy Wizard\footnote{\url{https://www.jqueryscript.net/other/Simple-Wizard-Modal-Plugin-with-jQuery-Bootstrap-Easy-Wizard.html}}. En el archivo \texttt{easyWizard.css} se han adaptado los colores para que coincidieran con los tonos usados en las \textit{progress bars} de Dr. Scratch, y el archivo \texttt{easyWizard.js} se ha sustituido por completo utilizando un script con un comportamiento totalmente personalizado.

En la parte inferior de la barra de progreso se muestra el nombre y la descripción del reto seleccionado y bajo estos, los valores establecidos en el reto en la columna \textit{Valor requerido} y los valores de la partida en la columna \textit{Puntuación más alta}.

Finalmente, en la parte inferior se encuentra un paginador, en el que cada página corresponde a un equipo incluido en el torneo.

\begin{figure}[H]
	\centering
 \includegraphics[width=8cm, keepaspectratio]{img/progreso}
 \caption{Progreso de los torneos}
 \label{fig:progreso}
\end{figure}

\subsubsection{Registrar a nuevos participantes}

La sección de registro de participantes consta de una única pantalla que incluye tres formularios. En ellos, los creadores podrán registrar de uno a veinte participantes al mismo tiempo, pudiendo usar cualquiera de las tres opciones indistintamente.

\begin{figure}[H]
	\centering
 \includegraphics[width=16cm, keepaspectratio]{img/registro_participantes}
 \caption{Registrar a nuevos participantes}
 \label{fig:registro_participantes}
\end{figure}

Los dos primeros formularios constan cada uno de un elemento de tipo \textit{File}. Al recibir el fichero adjunto, se comprueba que la extensión del archivo sea CSV y TXT respectivamente y se leen las primeras veinte líneas de los archivos utilizando la siguiente función:

\begingroup
	\fontsize{7pt}{8pt}\selectfont
	\begin{verbatim}
	    username = file.readline().rstrip()
	\end{verbatim}
\endgroup

En el tercer formulario se establecen veinte campos de tipo \textit{input}. Mediante \texttt{jQuery} se ocultan todos los \textit{inputs} salvo el primero y cuando el creador pulsa el botón \texttt{+} se muestra el siguiente \textit{input}. La función \texttt{jQuery} utilizada es la siguiente:

\begingroup
	\fontsize{7pt}{8pt}\selectfont
	\begin{verbatim}
	    $(document).on("ready", function(){
          $('.row-line').eq(0).show();
      });
      $(".plus-link").on("click", function(){
	        newId = parseInt(this.id)+1
	        if ($('.row-line').eq(newId).length > 0){
		          $('.row-line').eq(newId).show();
	         }
	         $(this).hide();
       });
	\end{verbatim}
\endgroup

Posteriormente, se registran uno por uno los participantes comprobando que aún no se encuentran registrados y utilizando el nombre de usuario recibido también como contraseña.

Existe una diferencia entre los participantes registrados usando una dirección de correo electrónico y los registrados usando un nombre de usuario. Si los participantes no tienen dirección de correo electrónico propia, el email de recuperación de contraseña se enviará a la dirección del creador que los haya registrado.

\newpage
\subsection{Funcionalidades para participantes}

Los participantes cuentan con una única función, que es la de jugar. En su caso no existirá un menú con secciones, sino que al acceder al módulo de torneos se mostrará la página de selección de equipo.

La página de selección de equipo consta de un panel central en el que se muestra el nombre, la descripción y los participantes del equipo. En rojo se resalta el nombre del participante que ha iniciado sesión.

En la parte inferior aparecerá un paginador si el participante está incluido en más de un equipo, en este caso cada página corresponderá a un equipo.

\begin{figure}[H]
	\centering
 \includegraphics[width=10cm, keepaspectratio]{img/participantes_seleccion}
 \caption{Selección de equipo}
 \label{fig:participantes_seleccion}
\end{figure}

Pulsando el botón \textit{Torneos}, el participante seleccionará el equipo con el que quiere participar.

Al seleccionar el equipo, se accede a la página principal de juego. A su vez, si el equipo seleccionado por el jugador estuviera incluido en más de un torneo, a través de un paginador podría cambiar de torneo en el que participar.

La página principal de juego consta de dos paneles. 

A la izquierda se muestra un panel con el progreso de la partida del jugador. Este panel tiene el mismo formato que el mostrado en la figura 4.20. Se mantiene el mismo código de colores, pero en este caso, los participantes no pueden pasar al siguiente reto hasta que no hayan superado el reto en curso, por lo que el botón \textit{Siguiente} no se mostrará.
Sin embargo, si el participante ha superado el reto sí dispondrá del botón \textit{Anterior} para permitirle mejorar la puntuación obtenida en el reto superado.

A la derecha, se muestra el panel de análisis de proyectos Scratch. Este panel coincide con el panel original que se encuentra en la página principal de Dr. Scratch. Analiza proyectos Scratch en versión 3.0 a través de su URL o adjuntándolos mediante un archivo de tipo \textit{File}.

\begin{figure}[H]
	\centering
 \includegraphics[width=12cm, keepaspectratio]{img/principal_participantes}
 \caption{Página principal de juego}
 \label{fig:principal_participantes}
\end{figure}

Se ha modificado la función de análisis de los proyectos Scratch para incluir la evaluación de las partidas en los torneos. La función de evaluación de la partida es la siguiente:
\newpage
\begingroup
	\fontsize{7pt}{8pt}\selectfont
	\begin{verbatim}
	    game.done = True
      if (tournament.manualValidation):
	        game.completed = False
      else:
	        game.completed = True
      for key, value in d["mastery"].items():
	        if (key != 'points' and key != 'maxi'):
		          if (value > getattr(game, trans_keys[key])):
			            setattr(game, trans_keys[key], value)
		          if (getattr(game, trans_keys[key]) < getattr(challenge, trans_keys[key])):
			            game.completed = False
			            game.done = False
		          game_value = getattr(game, trans_keys[key])
		          total_points = total_points + game_value
		          d["mastery"][key] = game_value
      d["mastery"]["points"] = total_points
	\end{verbatim}
\endgroup

La función comprueba uno por uno los parámetros analizados, por un lado comprueba si el valor del parámetro analizado es mayor que el existente en la partida y si es así, lo sobrescribe. Por otro, comprueba si algún valor de la partida es menor a su correspondiente valor en el reto, en cuyo caso establece la partida como no finalizada. La partida solo se establece como completada si la validación es automática.

Al analizar un proyecto Scratch la aplicación redirige automáticamente a la página de resultados. Esta página de resultados es una modificación de la página del resultado del análisis, original de Dr.  Scratch.

Se ha incluido un panel superior que indica a los usuarios si han superado o no el reto a través de un mensaje. En este panel superior se incluye el botón \textit{Volver} para regresar a la página principal de juego y un enlace al tutorial de Dr. Scratch mediante el botón \textit{Aprende cómo}.

Los mensajes mostrados pueden ser tres, un mensaje que indica que se ha completado el reto, un mensaje que indica que no se ha completado el reto y un mensaje que indica que la puntuación debe ser validada por el profesor para completar el reto.


\begin{figure}[H]
	\centering
 \includegraphics[width=10cm, keepaspectratio]{img/mensajes}
 \caption{Mensajes de la página de resultados}
 \label{fig:mensajes}
\end{figure}

Se ha modificado también el panel principal, situado a la derecha, en el que se muestran, en lugar del resultado del análisis, los valores de los parámetros del reto y la puntuación más alta de la partida del equipo.
De la pantalla del resultado del análisis de Dr. Scratch se han mantenido los paneles situados a la izquierda indicando al participante el nivel y los detalles a corregir del resultado de su análisis. 
También se ha mantenido el formato, variando la apariencia de la pantalla de resultados entre los tres niveles posibles: básico, medio y alto.  

\begin{figure}[H]
  		\centering
 		 \includegraphics[width=8cm, keepaspectratio]{img/resultado_basico}
		 \includegraphics[width=8cm, keepaspectratio]{img/resultado_medio}
		 \includegraphics[width=8cm, keepaspectratio]{img/resultado_alto}
 		 \caption{Página de resultados: Nivel básico, medio y alto}
 		 \label{fig:pagina_resultados}
	\end{figure}
	
Por último, cuando un participante haya completado el torneo, en la página principal de juego aparecerán los iconos de los distintos retos en verde y un mensaje  que indique que el torneo se ha completado.

\begin{figure}[H]
  		\centering
 		 \includegraphics[width=14cm, keepaspectratio]{img/torneo_completado}
 		 \caption{Torneo completado}
 		 \label{fig:torneo_completado}
	\end{figure}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% RESULTADOS %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\cleardoublepage
\chapter{Resultados}

Para comprobar la viabilidad del proyecto, se ha probado la aplicación en un entorno real. 
Se ha contado con la ayuda de Jorge, un profesor del C.E.I.P. Lope de Vega de Madrid, que ha realizado varios torneos con alumnos de 4º de primaria.

Para que la aplicación estuviera disponible, primero se ha realizado un despliegue a través de Azure, tanto de la aplicación web como de la base de datos.

Para la base de datos se ha optado por crear un recurso de Servidor de Azure Database for PostgreSQL. Originariamente se contaba con una instancia de base de datos de MySQL por lo que se ha modificado el atributo \texttt{DATABASES} del archivo \texttt{settings.py}.

\begingroup
	\fontsize{7pt}{8pt}\selectfont
	\begin{verbatim}
	    'ENGINE': 'django.db.backends.postgresql_psycopg2'
	\end{verbatim}
\endgroup

Para el despliegue de la aplicación se ha creado un recurso App Service gratuito de un núcleo de 1GB de almacenamiento.

Para poder desplegar correctamente la aplicación en el recurso creado, se ha realizado una serie de modificaciones entre las que se incluye la creación de un archivo \texttt{requirements.txt} que permite, mediante la consola de Kudu de Azure, la instalación de los plugins de Python necesarios para el funcionamiento de la aplicación, tales como Hairball o Kurt.

Así mismo, se incluyen los archivos \texttt{web.config} y \texttt{run\_waitress\_server.py} para la correcta publicación de la aplicación incluyendo sus archivos estáticos \footnote{\url{https://blogs.msdn.microsoft.com/azureossds/2017/09/01/django-app-with-httpplatformhandler-in-azure-app-services-windows}}.

\newpage
Una vez desplegada la aplicación, Jorge y sus alumnos utilizaron el módulo de torneos con Dr. Scratch para crear torneos y evaluar sus proyectos Scratch. Estas pruebas duraron tres meses y finalmente tanto Jorge como sus alumnos contestaron a un breve cuestionario para ofrecer su impresión sobre la aplicación. Los resultados de los cuestionarios son los siguientes.

\begin{figure}[H]
	\centering
 \includegraphics[width=14cm, keepaspectratio]{img/cuestionario_creadores}
 \caption{Respuestas del cuestionario de creadores}
 \label{fig:cuestionario_creadores}
\end{figure}

\begin{figure}[H]
	\centering
 \includegraphics[width=16cm, keepaspectratio]{img/cuestionario_participantes}
 \caption{Respuestas del cuestionario de participantes}
 \label{fig:cuestionario_participantes}
\end{figure}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% CONCLUSIONES %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\cleardoublepage
\chapter{Conclusiones}
\label{chap:conclusiones}


\section{Consecución de objetivos}
\label{sec:consecucion-objetivos}

Pese a haber realizado las pruebas en un entorno reducido y disponer de escasa retroalimentación,  los resultados se consideran satisfactorios.

El principal objetivo, que era proporcionar una aplicación que resultara atractiva a los alumnos y fomentara el uso de Dr. Scratch, parece haberse conseguido, ya que a la pregunta \textit{¿Te ha resultado más entretenido hacer los proyectos Scratch usando torneos con Dr. Scratch?} el 100\% de los alumnos ha respondido que sí.

Por otro lado, los estudiantes han considerado que la aplicación es suficientemente intuitiva, un 87.5\% consideran que era fácil de utilizar. Esta respuesta resulta especialmente significativa si tenemos en cuenta que se trata de alumnos de 4º de primaria, de edades en torno a 9 o 10 años. Resulta interesante que el rango de edades de uso de la aplicación sea lo más amplio posible.

Y por último, los alumnos consideran que la aplicación les ha ayudado a mejorar sus proyectos Scratch, contestando con \textit{Bastante} (57,1\%) o \textit{Mucho} (42,9\%). Por lo tanto, en base a las respuestas obtenidas consideramos que de parte de los estudiantes se han cumplido a grandes rasgos los objetivos establecidos en una primera fase del proyecto.


En cuanto a los resultados de la encuesta para profesores, pese a contar con un solo caso de uso, se ha obtenido información suficiente para la mejora de la aplicación en trabajos futuros.

Gracias a la información proporcionada por Jorge, el profesor encargado de realizar las pruebas, se ha llegado a la conclusión de que la aplicación, en su estado actual, permite el control por parte del profesor de los torneos y equipos creados y de los proyectos realizados por los alumnos. 
Sin embargo, la administración y el control del registro y del perfil de los participantes y un histórico de su participación en los distintos torneos son algunos de los aspectos a mejorar. 

También se llega a la conclusión de que el menú de creadores, más complejo y amplio que el de participantes, no resulta del todo intuitivo por lo que es otro punto a mejorar.

\section{Aplicación de lo aprendido}
\label{sec:aplicacion}

A lo largo del proyecto se han aplicado los conocimientos de programación de manera general, y en particular los conocimientos previos obtenidos en las tecnologías utilizadas en el proyecto, tales como Python y Django o HTML, CSS, JavaScript, etc.

Las asignaturas que más han contribuido en el conocimiento previo a la hora de realizar este proyecto son las siguientes:
\begin{itemize}
	\item Fundamentos de programación. Conceptos generales de la programación orientada a objetos.
\end{itemize}
\begin{itemize}
	\item Aplicaciones telemáticas. Conocimiento de HTML, CSS, JavaScript, JQuery y Bootstrap.
\end{itemize}
\begin{itemize}
	\item Servicios y aplicaciones telemáticas y Desarrollo de aplicaciones telemáticas. Creación de aplicaciones en lenguaje Python con el uso de Django.
\end{itemize}

\section{Lecciones aprendidas}
\label{sec:lecciones_aprendidas}

Entre las lecciones aprendidas en este proyecto, sin duda destacaría dos.

Por un lado, el aprendizaje del lenguaje de programación Python y el framework Django. Con una base ya obtenida a lo largo de la titulación de grado he podido afrontar con garantías la realización del proyecto y aprender con mayor profundidad el uso tanto de Python como de Django.

Por otro, el uso de Azure, la creación de recursos y el despliegue de aplicaciones en la nube. Esto lo considero de especial relevancia para mi carrera profesional dado que en estos momentos se encuentra orientada hacia el desarrollo de aplicaciones con arquitectura de microservicios.

\section{Trabajos futuros}
\label{sec:trabajos_futuros}

Dadas las conclusiones obtenidas tras la realización de las pruebas, existen una serie de aspectos a mejorar en la aplicación actual.
\begin{itemize}
	\item Simplificación de contenidos y mejora estética para hacer más intuitiva la aplicación sin que esto conlleve una pérdida en la información proporcionada.
\end{itemize}
\begin{itemize}
	\item Inclusión de imágenes en los perfiles de los participantes, permitiendo que los participantes tengan asociado un personaje con una imagen y así aumentar el carácter lúdico de la aplicación.
\end{itemize}
\begin{itemize}
	\item Incluir un menú de administración de participantes para el creador en el que pueda eliminar participantes registrados, modificar sus contraseñas, etc.
\end{itemize}
\begin{itemize}
	\item Un apartado para creadores que incluya un registro histórico de las partidas de cada participante incluyendo las URLs de los proyectos evaluados en esas partidas. 
\end{itemize}
\begin{itemize}
	\item Una opción para creadores que permita, sin necesidad de registrar otro correo electrónico, acceder él mismo como participante y de este modo comprobar el menú al que pueden acceder los alumnos.
\end{itemize}
\begin{itemize}
	\item Hacer parametrizable el número de alumnos por equipo y el número de equipos por torneo.
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% APÉNDICE(S) %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\cleardoublepage
\appendix
\chapter{Manual de usuario}
\label{app:manual}

Para utilizar la aplicación de Dr. Scratch que incluye el módulo de torneos es necesario realizar los siguientes pasos:

\begin{itemize}
	\item Instalar Python 2.7\footnote{\url{https://www.python.org/download/releases/2.7}}.
\end{itemize}
\begin{itemize}
	\item Descargar el código de la aplicación\footnote{\url{https://github.com/alvarofdez/drScratch}}.
\end{itemize}
\begin{itemize}
	\item Modificar los valores del parámetro \texttt{DATABASES} en el archivo \texttt{settings.py} para configurar la base de datos local del usuario.
\end{itemize}
\begin{itemize}
	\item Abrir una consola en el directorio raíz con el código descargado.
\end{itemize}
\begin{itemize}
	\item Ejecutar el comando \texttt{python -m pip install -r requirements.txt}.
\end{itemize}
\begin{itemize}
	\item Ejecutar el comando \texttt{python manage.py migrate}.
\end{itemize}
\begin{itemize}
	\item Ejecutar el comando \texttt{python manage.py runserver}.
\end{itemize}
\begin{itemize}
	\item Abrir el navegador y escribir en la barra de dirección la siguiente URL: \texttt{http://localhost:8000}.
\end{itemize}

El manual de usuario completo de la aplicación se encuentra en la siguiente dirección: \url{https://github.com/alvarofdez/drScratch/blob/master/Torneos_Dr_Scratch_Manual_De_Usuario.pdf}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% BIBLIOGRAFIA %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\cleardoublepage

% Las siguientes dos instrucciones es todo lo que necesitas
% para incluir las citas en la memoria
\bibliographystyle{abbrv}
\bibliography{MemoriaTFG-AlvaroFernandezRoig}  % MemoriaTFG-AlvaroFernandezRoig.bib es el nombre del fichero que contiene
% las referencias bibliográficas. Abre ese fichero y mira el formato que tiene,
% que se conoce como BibTeX. Hay muchos sitios que exportan referencias en
% formato BibTeX. Prueba a buscar en http://scholar.google.com por referencias
% y verás que lo puedes hacer de manera sencilla.
% Más información: 
% http://texblog.org/2014/04/22/using-google-scholar-to-download-bibtex-citations/

\end{document}
